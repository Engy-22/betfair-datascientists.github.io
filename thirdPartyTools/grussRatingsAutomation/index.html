



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation, guides and articles on creating, developing and implementing automated betting strategies, using data analysis to inform betting models and how to interact with the Betfair API.">
      
      
        <link rel="canonical" href="https://betfair-datascientists.github.io/thirdPartyTools/grussRatingsAutomation/">
      
      
        <meta name="author" content="Betfair Data Scientists">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/BetfairFavicon.ico">
      <meta name="generator" content="mkdocs-1.0.2, mkdocs-material-3.0.4">
    
    
      
        <title>Gruss Betting Assistant - ratings automation - Automation & Data Analysis</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.66a59cf2.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    <link rel="stylesheet" href="../../assets/fonts/clarke-regular.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#gruss-betting-assistant-ratings-automation" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://betfair-datascientists.github.io" title="Automation & Data Analysis" class="md-header-nav__button md-logo">
          
            <img src="../../img/logo.svg" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Automation & Data Analysis
              </span>
              <span class="md-header-nav__topic">
                Gruss Betting Assistant - ratings automation
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="Resources" class="md-tabs__link">
          Resources
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../betAngelRatingsAutomation/" title="Third Party Tools" class="md-tabs__link">
          Third Party Tools
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../historicdata/" title="Historic Data" class="md-tabs__link">
          Historic Data
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="https://www.betfair.com.au/exchange/plus/" title="Betfair Exchange" class="md-tabs__link">
          Betfair Exchange
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="https://www.betfair.com.au/hub" title="Back to the Hub" class="md-tabs__link">
          Back to the Hub
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://betfair-datascientists.github.io" title="Automation & Data Analysis" class="md-nav__button md-logo">
      
        <img src="../../img/logo.svg" width="48" height="48">
      
    </a>
    Automation & Data Analysis
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Resources
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Resources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="External data & dev resources" class="md-nav__link">
      External data & dev resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Third Party Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Third Party Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../betAngelRatingsAutomation/" title="Bet Angel - ratings automation" class="md-nav__link">
      Bet Angel - ratings automation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../betAngelMarketFavouriteAutomation/" title="Bet Angel - market favourite automation" class="md-nav__link">
      Bet Angel - market favourite automation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../betAngelTippingAutomation/" title="Bet Angel - tipping automation" class="md-nav__link">
      Bet Angel - tipping automation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Historic Data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Historic Data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../historicdata/" title="Downloading the data" class="md-nav__link">
      Downloading the data
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Betfair Exchange
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Betfair Exchange
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="https://www.betfair.com.au/exchange/plus/" title="Betfair Exchange" class="md-nav__link">
      Betfair Exchange
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Back to the Hub
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Back to the Hub
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="https://www.betfair.com.au/hub" title="The Hub" class="md-nav__link">
      The Hub
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#automating-a-ratings-based-strategy-using-gruss-betting-assistant" title="Automating a ratings based strategy using Gruss Betting Assistant" class="md-nav__link">
    Automating a ratings based strategy using Gruss Betting Assistant
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-plan" title="The plan" class="md-nav__link">
    The plan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up" title="Set up" class="md-nav__link">
    Set up
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finding-formatting-ratings" title="Finding &amp; formatting ratings" class="md-nav__link">
    Finding &amp; formatting ratings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-a-rule" title="Writing a rule" class="md-nav__link">
    Writing a rule
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-to-place-bet" title="Trigger to place bet" class="md-nav__link">
    Trigger to place bet
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-the-spreadsheet" title="Preparing the spreadsheet" class="md-nav__link">
    Preparing the spreadsheet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selecting-markets" title="Selecting markets" class="md-nav__link">
    Selecting markets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linking-the-spreadsheet" title="Linking the spreadsheet" class="md-nav__link">
    Linking the spreadsheet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#and-youre-set" title="And you're set!" class="md-nav__link">
    And you're set!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gruss-features" title="Gruss features" class="md-nav__link">
    Gruss features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#areas-for-improvement" title="Areas for improvement" class="md-nav__link">
    Areas for improvement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-next" title="What next?" class="md-nav__link">
    What next?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disclaimer" title="Disclaimer" class="md-nav__link">
    Disclaimer
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="gruss-betting-assistant-ratings-automation">Gruss Betting Assistant - ratings automation<a class="headerlink" href="#gruss-betting-assistant-ratings-automation" title="Permanent link">&para;</a></h1>
<hr />
<h3 id="automating-a-ratings-based-strategy-using-gruss-betting-assistant">Automating a ratings based strategy using Gruss Betting Assistant<a class="headerlink" href="#automating-a-ratings-based-strategy-using-gruss-betting-assistant" title="Permanent link">&para;</a></h3>
<p>Ratings are the basis for a lot of betting strategies, but they can be paricularly painful and time-consuming to implement manually. This makes them ideal for automation, where you use a program to place bets on your behalf while you get on with other things. </p>
<p>Bet Angel Pro has a spreadsheet functionality that lets you place bets using your own variables and information from the live market, which is what I've used here to automate these ratings. There are so many different ways to use this part of Bet Angel and I'm very open to any thoughts about more effecitve ways of implementing this sort of strategy. You're welcome to reach out to me on <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#100;&#112;&#64;&#98;&#101;&#116;&#102;&#97;&#105;&#114;&#46;&#99;&#111;&#109;&#46;&#97;&#117;">&#98;&#100;&#112;&#64;&#98;&#101;&#116;&#102;&#97;&#105;&#114;&#46;&#99;&#111;&#109;&#46;&#97;&#117;</a> with your feedback and opinions. </p>
<hr />
<h3 id="the-plan">The plan<a class="headerlink" href="#the-plan" title="Permanent link">&para;</a></h3>
<p>I'm using the <a href="https://www.betfair.com.au/hub/tools/models/greyhound-ratings-model/">Greyhound Ratings Model</a> put together by some of my Data Scientist colleagues. This model creates ratings for Victorian greyhound races daily and is freely available on the Hub. It's pretty good at predicting winners, so I'm going to place back bets on the dogs with shorter ratings where the market price is better than the model's rating. Gruss Betting Assistant's Excel triggered betting feature has the capacity to let you create spreadsheets with pretty complicated rules that can be applied to multiple markets, which is what I've used for the automation here. </p>
<p>Here I'll step through how I went about getting Bet Angel Pro to place bets using the ratings from <a href="https://www.betfair.com.au/hub/tools/models/greyhound-ratings-model/">Betfair's DataScientists' Greyhound Ratings Model</a>. Once it's set up the goal is to be able to upload a new set of ratings, choose your races, set the program running and be able to walk away.</p>
<p><img alt="Automating a ratings based strategy with Gruss" src="../img/GrussRatingsHub.png" /></p>
<div class="admonition note">
<p class="admonition-title">Resources</p>
<ul>
<li>Tips: <a href="https://www.betfair.com.au/hub/tools/models/greyhound-ratings-model/">Betfair Data Scientists' Greyhound Ratings Model</a></li>
<li>Rules: <a href="">here's the spreadsheet</a> I set up with my rules included, but you'll obviously need to tweak it to suit your strategy and the format of your ratings </li>
<li>Tool: <a href="http://www.gruss-software.co.uk/betfair-products/betfair-betting-assistant">Gruss Betting Assistant</a></li>
</ul>
</div>
<hr />
<h3 id="set-up">Set up<a class="headerlink" href="#set-up" title="Permanent link">&para;</a></h3>
<p>Make sure you've downloaded and installed <a href="http://www.gruss-software.co.uk/betfair-products/betfair-betting-assistant">Gruss Betting Assistant</a>, and signed in.</p>
<p><img alt="Automating a rating strategy with Gruss" src="../img/GrussRatingsUI.png" /></p>
<hr />
<h3 id="finding-formatting-ratings">Finding &amp; formatting ratings<a class="headerlink" href="#finding-formatting-ratings" title="Permanent link">&para;</a></h3>
<p>Here I'm using the <a href="https://www.betfair.com.au/hub/tools/models/greyhound-ratings-model/">ratings shared by our Data Scientists on the Hub</a>. This makes for a bit of prep work, copying the list of runners and their rating into an Excel spreadsheet. As a minimum you'll need a list of runner names (including the runner number followed by a full stop, i.e. 1. Runner Name) in one column and their rating in another in an Excel sheet. </p>
<p>If you have a list of ratings already in a spreadsheet that's even better - you'll be able to tweak the Excel formulas to work with whatever format your data is in.</p>
<p>Wherever your ratings come from, you'll need to include them in the spreadsheet you're using to interact wtih Gruss. Here I'm using a <a href="">spreadsheet I edited for this strategy</a>, and I've included a tab called RATINGS where you can copy in the runner names and ratings.</p>
<p><img alt="Automating a ratings based strategy with Gruss" src="../img/GrussRatingsRunners.png" /></p>
<hr />
<h3 id="writing-a-rule">Writing a rule<a class="headerlink" href="#writing-a-rule" title="Permanent link">&para;</a></h3>
<p>As with any automated strategy, one of the most important steps is deciding what logical approach you want to take, and writing rules that suit. </p>
<p>I'm using a <a href="">customised version of the default Gruss template Excel sheet</a> to implement my strategy, so it can make betting decisions based on my ratings. Excel is an excellent tool, but it can take an investment of time to be able to use it effectively. There are lots of posts on the <a href="http://www.gruss-software.co.uk/forum/viewforum.php?f=8">Gruss Forum on the topic</a> if you want to explore it more yourself.</p>
<p>This is how I used Excel to implement my set of rules. </p>
<h4 id="trigger-to-place-bet">Trigger to place bet<a class="headerlink" href="#trigger-to-place-bet" title="Permanent link">&para;</a></h4>
<p>In short, I want to back runners when:</p>
<ul>
<li>the available to back price is better than the rating for that runner by at least 10%</li>
<li>they have a rating less than 5</li>
<li>the scheduled event start time is less than 2 minutes away </li>
<li>there isn't a bet already placed on the runner </li>
<li>the event isn't in play </li>
</ul>
<p><strong>This is my trigger on Excel formula:</strong></p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">Multi line</label>
<div class="superfences-content"><div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(
    AND(
        G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),
        INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, 
        Sheet2!$E$4 &lt; 120, 
        AB10 &lt; 1,
        ISBLANK($G$1)),
    &quot;BACK&quot;,
    &quot;&quot;
)
</pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">Single line</label>
<div class="superfences-content"><div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(AND(G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, Sheet2!$E$4 &lt; 120, AB10 &lt; 1, ISBLANK($G$1)),&quot;BACK&quot;,&quot;&quot;)
</pre></div></div>
</div>
<p>Stepping through each step:</p>
<ul>
<li><strong>Price &gt; rating:</strong> check whether the available to back price is better than the runner's rating multipled by 1.1 (10%) - I do this by using the runner name in column B and looking up the corresponding rating for that runner from the RATINGS sheet. </li>
</ul>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(
    AND(
<span style="background-color: #ffffcc">        G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),
</span>        INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, 
        Sheet2!$E$4 &lt; 120, 
        AB10 &lt; 1,
        ISBLANK($G$1)),
    &quot;BACK&quot;,
    &quot;&quot;
)
</pre></div>

<div class="admonition note">
<p class="admonition-title">Updating references to suit your ratings format</p>
<p>If your ratings are formatted differently to my simple runner <strong>name | rating</strong> layout you can easily edit the formula to refence the relevant column directly, instead of changing your ratings to fit the formula. 
Let's say your ratings sheet is set out like this: <strong>race date | venue | runner name | last race time | weight | rating</strong> </p>
<p>Here's the set up of the formula:</p>
<p><code>RATINGS!B:B[your rating],MATCH(B9,RATINGS!A:A[runner name],0))</code></p>
<p>So your edited formula would be:</p>
<p><code>RATINGS!F:F,MATCH(B9,RATINGS!C:C,0))</code></p>
<p>You need to make sure that you updated these references both in the this part of the formula, and in the next step too.  </p>
</div>
<ul>
<li><strong>Rating &lt; 5:</strong> check whether the runner's rating is less than 5 (because I only want to bet on the favourite few runners)</li>
</ul>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(
    AND(
        G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),
<span style="background-color: #ffffcc">        INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, 
</span>        Sheet2!$E$4 &lt; 120, 
        AB10 &lt; 1,
        ISBLANK($G$1)),
    &quot;BACK&quot;,
    &quot;&quot;
)
</pre></div>

<ul>
<li><strong>Time &lt; 2 mins:</strong> check whether the seconds left on the countdown are smaller than 120 (2 minutes), as the majority of markets don't fully form until the last few minutes before the off. </li>
</ul>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(
    AND(
        G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),
        INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, 
<span style="background-color: #ffffcc">        Sheet2!$E$4 &lt; 120, 
</span>        AB10 &lt; 1,
        ISBLANK($G$1)),
    &quot;BACK&quot;,
    &quot;&quot;
)
</pre></div>

<ul>
<li><strong>No existing bet:</strong> checking whether a bet's already been placed on the runner, as I only want the bet to place once. The number of bets matched on the runner shows in column AB - obviously there are other ways you can check this, but whichever one you go with you'll need a check in place to make sure your bets don't fire again and again, unless that's part of your strategy! </li>
</ul>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(
    AND(
        G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),
        INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, 
        Sheet2!$E$4 &lt; 120, 
<span style="background-color: #ffffcc">        AB10 &lt; 1,
</span>        ISBLANK($G$1)),
    &quot;BACK&quot;,
    &quot;&quot;
)
</pre></div>

<ul>
<li><strong>Not in play:</strong> checking whether the event has gone in play - as odds change so much in the run I only want to use this strategy pre-play. If this cell is blank it means it's not displaying the 'in-play' flag, so it's safe to place bets. I appreciate that greyhound races don't go in play, but I wanted this check in place anyway in case I (or you!) wanted to use a version of this strategy on horse racing in the future. </li>
</ul>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(
    AND(
        G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),
        INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, 
        Sheet2!$E$4 &lt; 120, 
        AB10 &lt; 1,
<span style="background-color: #ffffcc">        ISBLANK($G$1)),
</span>    &quot;BACK&quot;,
    &quot;&quot;
)
</pre></div>

<ul>
<li><strong>Result:</strong> if the statement above is true, the formula returns "BACK", at which point the bet will trigger, otherwise the cell will remain blank and no bet will be placed.</li>
</ul>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(
    AND(
        G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),
        INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, 
        Sheet2!$E$4 &lt; 120, 
        AB10 &lt; 1,
        ISBLANK($G$1)),
<span style="background-color: #ffffcc">    &quot;BACK&quot;,
</span><span style="background-color: #ffffcc">    &quot;&quot;
</span>)
</pre></div>

<div class="admonition note">
<p class="admonition-title">Excel functions</p>
<ul>
<li><a href="https://support.office.com/en-us/article/if-function-69aed7c9-4e8a-4755-a9bc-aa8bbff73be2">IF statement:</a> IF(if this is true, do this, else do this)</li>
<li><a href="https://support.office.com/en-us/article/and-function-5f19b2e8-e1df-4408-897a-ce285a19e9d9">AND statement:</a> AND(this is true, and so is this, and so is this) - returns true or false</li>
<li><a href="https://support.office.com/en-us/article/switch-between-relative-absolute-and-mixed-references-dfec08cd-ae65-4f56-839e-5f0d8d0baca9">Absolute references:</a> if you're copy/pasting formulas it's important that you make links absolute when you don't want the cell being referenced to change relative to the new cell the formula is being pasted into. You do this by putting a $ in front of the parts of the reference you don't want to 'move'. </li>
</ul>
</div>
<hr />
<h3 id="preparing-the-spreadsheet">Preparing the spreadsheet<a class="headerlink" href="#preparing-the-spreadsheet" title="Permanent link">&para;</a></h3>
<p>You need to copy/paste these three formulas into the relevant cell on each green row - I did a few extra rows than the number of runners in the markets I was looking at, just in case the fields are bigger in future events. Excel is clever enough to automatically update the relative links in the formulas, so you should be able to copy/paste the same formula into each cell as long as you've got your <a href="https://support.office.com/en-us/article/switch-between-relative-absolute-and-mixed-references-dfec08cd-ae65-4f56-839e-5f0d8d0baca9">relative and absolute references straight</a>. </p>
<ul>
<li><strong>Trigger bet rule:</strong> this is the bet trigger Excel formula we created earlier, and it needs to go in column AE (AE5 for the first runner).</li>
</ul>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">Multi line</label>
<div class="superfences-content"><div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(
    AND(
        G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),
        INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, 
        Sheet2!$E$4 &lt; 120, 
        AB10 &lt; 1,
        ISBLANK($G$1)),
    &quot;BACK&quot;,
    &quot;&quot;
)
</pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">Single line</label>
<div class="superfences-content"><div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>=IF(AND(G9 &gt; (INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0))*1.1),INDEX(RATINGS!B:B,MATCH(B9,RATINGS!A:A,0)) &lt; 5, Sheet2!$E$4 &lt; 120, AB10 &lt; 1, ISBLANK($G$1)),&quot;BACK&quot;,&quot;&quot;)
</pre></div></div>
</div>
<p><img alt="Automating a ratings based strategy with Gruss" src="" /></p>
<ul>
<li><strong>Odds:</strong> initially I was using the runner's rating as the price, but I got a bet placement error for some of the selections - eventually I realised that the odds the bet's being placed at need to be <a href="https://docs.developer.betfair.com/display/1smk3cen4v3lu3yomq5qye0ni/placeOrders#placeOrders-BetfairPriceIncrements">valid Betfair 'ticks'</a>. For simplicity's sake I'm now just using the currently available back odds (cell G5 for the first runner). This goes in column R (R5 for the first runner). Another option would be to create a look up table that rounded your rating to the nearest <a href="https://docs.developer.betfair.com/display/1smk3cen4v3lu3yomq5qye0ni/placeOrders#placeOrders-BetfairPriceIncrements">'tick' price</a> - if you do this, please do <a href="mailto:bdp@betfair.com.au">send me</a> through your formula and I'll add it to this article.</li>
</ul>
<p><code>=R5</code></p>
<p><img alt="Automating a ratings based strategy with Gruss" src="" /></p>
<ul>
<li><strong>Stake:</strong> it's completely up to you what staking approach you want to take. I've kept it simple, and am just using a 'to win' strategy. Each bet aims to win $10 on that runner at the curret odds. The formula divides $10 by the current available best back odds (cell R5 for the first runner) minus one to get the stake required to win $10. This goes in column AC (AC5 for the first runner). We've got some <a href="https://www.betfair.com.au/hub/better-betting/betting-principles/basic-principles/staking-plans-and-strategies/">good resources on the Hub</a> that look at different staking approaches - these might be useful in helping you decide which strategy you want to use. </li>
</ul>
<p><code>=10/(R5-1)</code></p>
<p><img alt="Automating a ratings based strategy with Gruss" src="" /></p>
<hr />
<h3 id="selecting-markets">Selecting markets<a class="headerlink" href="#selecting-markets" title="Permanent link">&para;</a></h3>
<p>TO DO</p>
<p><img alt="Automating a ratings based strategy with Gruss" src="" /></p>
<hr />
<h3 id="linking-the-spreadsheet">Linking the spreadsheet<a class="headerlink" href="#linking-the-spreadsheet" title="Permanent link">&para;</a></h3>
<p>TO DO</p>
<p><img alt="Automating a ratings based strategy with Gruss" src="" /></p>
<hr />
<h3 id="and-youre-set">And you're set!<a class="headerlink" href="#and-youre-set" title="Permanent link">&para;</a></h3>
<p>Once you've set your spreadsheet set up and you're comfortable using Gruss Betting Assistant it should only take a number of seconds to load your markets and ratings up and set your strategy running for the day. Just make sure you have all of the app settings correctly selected before you leave the bot to run, as some of them reset by default when you turn the program off.</p>
<p><em>Note: you will need to leave your computer up and running for the duration of the chosen markets, as the program needs the computer to be 'awake' to be able to run.</em></p>
<hr />
<h3 id="gruss-features">Gruss features<a class="headerlink" href="#gruss-features" title="Permanent link">&para;</a></h3>
<p>Here are some Bet Angel features that you'll need to consider:</p>
<ul>
<li><strong>Clearing status cells:</strong> if there is a value in the status cell then no bets will place for that runner, to avoid placing duplicate bets accidentally. As we want to use the same sheet for multiple races, and our bet trigger rule includes a check to see whether we already have a bet on the runner, I created a macro in <a href="../assets/BetAngel_RatingsAutomation.xls">the Excel sheet</a> that auto-clears the status cells every 5 seconds. This was based on some logic I found in <a href="https://www.betangel.com/forum/viewtopic.php?f=31&amp;t=1879&amp;start=10">a forum discussion on Bet Angel</a>.</li>
<li><strong>Turning off bet confirmation:</strong> unless you want to manually confirm each individual bet you're placing (which you definitely might want to do until you feel comfortable that the program and strategy are behaving as you expect) you'll need to go into the 'Settings' tab on the main Bet Angel Pro program, click 'Edit settings', go to the 'Behaviour' tab, and remove the tick at the top next to 'Confirm Bets?'. You can then save these settings, but you'll need to go into the settings tab and choose the saved file each time you open the program to change the default confirmation behaviour.</li>
<li><strong>Editing the spreadsheet:</strong> the spreadsheet really doesn't like it when you try and edit it 'live', so make sure you untick 'connect' on the Excel tab in Guardian before you make any changes, save the sheet, then tick 'connect' again once you've finished your edits. </li>
</ul>
<hr />
<h3 id="areas-for-improvement">Areas for improvement<a class="headerlink" href="#areas-for-improvement" title="Permanent link">&para;</a></h3>
<p>There are parts of this approach that I'm still trying to get to work to my liking, and I'll update this article as I find better solutions. If you have any suggestions for improvements please reach out to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#100;&#112;&#64;&#98;&#101;&#116;&#102;&#97;&#105;&#114;&#46;&#99;&#111;&#109;&#46;&#97;&#117;">&#98;&#100;&#112;&#64;&#98;&#101;&#116;&#102;&#97;&#105;&#114;&#46;&#99;&#111;&#109;&#46;&#97;&#117;</a> - I'd love to hear your thoughts. </p>
<p>For example, the spreadsheet only binds with one market at a time, so if one market gets delayed and runs overtime the program won't be able to move on to the next market - I missed some races because of this. </p>
<hr />
<h3 id="what-next">What next?<a class="headerlink" href="#what-next" title="Permanent link">&para;</a></h3>
<p>We're working through some of the popular automation tools and creating articles like this one to help you learn how to use them to implement different styles of strategies. If you have any thoughts or feedback on this article or other programs you'd like to see us explore please reach out to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#100;&#112;&#64;&#98;&#101;&#116;&#102;&#97;&#105;&#114;&#46;&#99;&#111;&#109;&#46;&#97;&#117;">&#98;&#100;&#112;&#64;&#98;&#101;&#116;&#102;&#97;&#105;&#114;&#46;&#99;&#111;&#109;&#46;&#97;&#117;</a> </p>
<hr />
<h3 id="disclaimer">Disclaimer<a class="headerlink" href="#disclaimer" title="Permanent link">&para;</a></h3>
<p>Note that whilst automated strategies are fun and rewarding to create, we can't promise that your betting strategy will be profitable. If you're implementing your own strategies please gamble responsibly and note that you are responsible for any winnings/losses incurred.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://twitter.com/Betfair_Aus" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/company/betfair-australia" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://facebook.com/betfareaustralia" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://youtube.com/user/betfairaus" class="md-footer-social__link fa fa-youtube"></a>
    
      <a href="https://github.com/betfair-datascientists" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
    <div class="bf-footer">
      <p class="bf-light">Betfair Pty Limited is licensed and regulated by the Northern Territory Government of Australia.</p>
      <p class="bf-dark">Betfair Pty Limited's gambling operations are governed by its Responsible Gambling Code of Conduct and for South
      Australian residents by the South Australian Responsible Gambling Code of Practice.<br>Think! About your choices. Don’t let the game play you. Stay in control. Gamble Responsibly.
      Call Gambling Help 1800 858 858 <a href="https://gamblinghelponline.org.au">www.gamblinghelponline.org.au</a></p>
      <ul class="bf-links">
        <li><a href="https://www.betfair.com.au/hub/help/account-help/responsible-gambling/">Responsible Gambling</a><span>|</span></li>
        <li><a href="http://www.betfair.com/AUS_NZL/aboutUs/Terms.and.Conditions/">Terms & Conditions</a><span>|</span></li>
        <li><a href="https://www.betfair.com.au/info/privacy-policy/">Privacy Policy</a><span>|</span></li>
        <li><a href="http://www.betfair.com/en/aboutUs/Rules.and.Regulations/">Rules & Regulations</a><span>|</span></li>
        <li><a href="https://www.betfair.com/AUS_NZL/aboutUs/Dispute.Resolution">Dispute Resolution</a></li>
      </ul>
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.83382bb6.js"></script>
      
      <script>app.initialize({version:"1.0.2",url:{base:"../.."}})</script>
      
        <script src="../../search/main.js"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-125973915-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>